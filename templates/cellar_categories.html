{% extends "base.html" %}
{% block content %}
<div class="d-flex justify-content-between align-items-center mb-4">
  <h3>Catégories de caves</h3>
  <a href="{{ url_for('add_cellar_category') }}" class="btn btn-dark">+ Nouvelle catégorie</a>
</div>

{% if not categories %}
<div class="alert alert-info">
  Aucune catégorie définie. Créez-en une pour organiser vos caves.
</div>
{% else %}
  {% for category in categories %}
  <div class="card mb-3">
    <div class="card-header d-flex justify-content-between align-items-center">
      <h5 class="mb-0">{{ category.name }}</h5>
      <div>
        <a href="{{ url_for('edit_cellar_category', category_id=category.id) }}" class="btn btn-sm btn-outline-secondary">Modifier</a>
        <form method="POST" action="{{ url_for('delete_cellar_category', category_id=category.id) }}" style="display:inline;" onsubmit="return confirm('Êtes-vous sûr de vouloir supprimer cette catégorie ?');">
          <button type="submit" class="btn btn-sm btn-outline-danger">Supprimer</button>
        </form>
      </div>
    </div>
    <div class="card-body">
      {% if category.description %}
      <p class="text-muted mb-2">{{ category.description }}</p>
      {% endif %}
      
      {% set cellars_count = category.cellars|length %}
      <p class="mb-0">
        <small class="text-muted">
          {{ cellars_count }} cave{% if cellars_count > 1 %}s{% endif %} dans cette catégorie
        </small>
      </p>
    </div>
  </div>
  {% endfor %}
{% endif %}

<div class="mt-4">
  <a href="{{ url_for('list_cellars') }}" class="btn btn-secondary">← Retour aux caves</a>
</div>
{% endblock %}
{% extends "base.html" %}
{% block content %}
<h3>Ajouter une sous-catégorie à "{{ category.name }}"</h3>
<form method="POST">
  <input type="hidden" name="csrf_token" value="{{ csrf_token() }}" />
  <div class="mb-3">
    <label class="form-label">Nom de la sous-catégorie</label>
    <input type="text" class="form-control" name="name" value="{{ name or '' }}" required placeholder="Ex: Vin rouge, Rhum ambré">
  </div>
  <div class="mb-3">
    <label class="form-label">Description</label>
    <textarea class="form-control" name="description" rows="2" placeholder="Description optionnelle">{{ description or '' }}</textarea>
  </div>
  <div class="mb-3">
    <label class="form-label">Ordre d'affichage</label>
    <input type="number" class="form-control" name="display_order" value="{{ display_order or 0 }}" min="0">
    <div class="form-text">Les sous-catégories sont triées par ordre croissant (0 = premier)</div>
  </div>
  <div class="row">
    <div class="col-md-6 mb-3">
      <label class="form-label">Couleur du badge</label>
      <input type="color" class="form-control form-control-color" name="badge_bg_color" id="badge_bg_color" value="{{ badge_bg_color or '#6366f1' }}" title="Choisissez la couleur de fond du badge">
    </div>
    <div class="col-md-6 mb-3">
      <label class="form-label">Couleur du texte</label>
      <input type="color" class="form-control form-control-color" name="badge_text_color" id="badge_text_color" value="{{ badge_text_color or '#ffffff' }}" title="Choisissez la couleur du texte">
    </div>
  </div>
  <div class="mb-3">
    <span class="badge" id="badge_preview" style="background-color: {{ badge_bg_color or '#6366f1' }}; color: {{ badge_text_color or '#ffffff' }};">Aperçu du badge</span>
  </div>
  <div class="d-flex gap-2">
    <button type="submit" class="btn btn-dark">Créer</button>
    <a href="{{ url_for('categories.list_categories') }}" class="btn btn-secondary">Annuler</a>
  </div>
</form>

<script>
document.addEventListener('DOMContentLoaded', function() {
  const bgColorInput = document.getElementById('badge_bg_color');
  const textColorInput = document.getElementById('badge_text_color');
  const badgePreview = document.getElementById('badge_preview');

  function updateBadgePreview() {
    badgePreview.style.backgroundColor = bgColorInput.value;
    badgePreview.style.color = textColorInput.value;
  }

  bgColorInput.addEventListener('input', updateBadgePreview);
  textColorInput.addEventListener('input', updateBadgePreview);
});
</script>
{% endblock %}